--- a/MagickCore/distribute-cache.c.orig	2018-12-26 08:36:39.624517664 +0100
+++ b/MagickCore/distribute-cache.c	2018-12-26 08:37:27.240625981 +0100
@@ -89,6 +89,8 @@
 #define LENGTH_TYPE size_t
 #define MAGICKCORE_HAVE_DISTRIBUTE_CACHE
 #elif defined(MAGICKCORE_WINDOWS_SUPPORT) && !defined(__MINGW32__)
+#include <winsock2.h>
+#include <ws2tcpip.h>
 #define CHAR_TYPE_CAST (char *)
 #define CLOSE_SOCKET(socket) (void) closesocket(socket)
 #define HANDLER_RETURN_TYPE DWORD WINAPI
--- a/MagickCore/nt-base.h.orig	2018-12-26 08:40:27.833033590 +0100
+++ b/MagickCore/nt-base.h	2018-12-26 08:40:44.985072087 +0100
@@ -39,6 +39,8 @@
 #include <errno.h>
 #include <malloc.h>
 #include <sys/utime.h>
+#include <winsock2.h>
+#include <ws2tcpip.h>
 #if defined(_DEBUG) && !defined(__MINGW32__)
 #include <crtdbg.h>
 #endif
--- a/configure.ac.orig	2018-12-26 04:10:18.000000000 +0100
+++ b/configure.ac	2018-12-26 04:11:00.000000000 +0100
@@ -2778,7 +2778,7 @@
             AC_MSG_RESULT([no -- some components failed test])
             have_tiff='no (failed tests)'
         else
-            TIFF_LIBS='-ltiff'
+            TIFF_LIBS='-ltiff -llzma'
             LIBS="$TIFF_LIBS $LIBS"
             AC_DEFINE(TIFF_DELEGATE,1,Define if you have TIFF library)
             AC_MSG_RESULT([yes])
--- a/configure.orig	2018-12-26 04:27:04.000000000 +0100
+++ b/configure	2018-12-26 04:27:07.000000000 +0100
@@ -33098,7 +33098,7 @@
   $as_echo_n "(cached) " >&6
 else
   ac_check_lib_save_LIBS=$LIBS
-LIBS="-ltiff  $LIBS"
+LIBS="-ltiff -llzma $LIBS"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
@@ -33140,7 +33140,7 @@
   $as_echo_n "(cached) " >&6
 else
   ac_check_lib_save_LIBS=$LIBS
-LIBS="-ltiff  $LIBS"
+LIBS="-ltiff -llzma $LIBS"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
@@ -33182,7 +33182,7 @@
   $as_echo_n "(cached) " >&6
 else
   ac_check_lib_save_LIBS=$LIBS
-LIBS="-ltiff  $LIBS"
+LIBS="-ltiff -llzma $LIBS"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
@@ -33224,7 +33224,7 @@
   $as_echo_n "(cached) " >&6
 else
   ac_check_lib_save_LIBS=$LIBS
-LIBS="-ltiff  $LIBS"
+LIBS="-ltiff -llzma $LIBS"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
@@ -33266,7 +33266,7 @@
   $as_echo_n "(cached) " >&6
 else
   ac_check_lib_save_LIBS=$LIBS
-LIBS="-ltiff  $LIBS"
+LIBS="-ltiff -llzma $LIBS"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
@@ -33310,7 +33310,7 @@
 $as_echo "no -- some components failed test" >&6; }
             have_tiff='no (failed tests)'
         else
-            TIFF_LIBS='-ltiff'
+            TIFF_LIBS='-ltiff -llzma'
             LIBS="$TIFF_LIBS $LIBS"
 
 $as_echo "#define TIFF_DELEGATE 1" >>confdefs.h
--- a/configure.orig	2018-12-31 01:05:24.755459290 +0100
+++ b/configure	2018-12-31 01:06:29.946508641 +0100
@@ -36687,9 +36687,9 @@
 if test "$have_djvu"    = 'yes' ; then
    MAGICK_DELEGATES="$MAGICK_DELEGATES djvu"
 fi
-if test "$have_avconv"   = 'yes' ; then
-   MAGICK_DELEGATES="$MAGICK_DELEGATES mpeg"
-fi
+#if test "$have_avconv"   = 'yes' ; then
+#   MAGICK_DELEGATES="$MAGICK_DELEGATES mpeg"
+#fi
 if test "$have_fftw"    = 'yes' ; then
    MAGICK_DELEGATES="$MAGICK_DELEGATES fftw"
 fi
@@ -36742,11 +36742,11 @@
    MAGICK_DELEGATES="$MAGICK_DELEGATES png"
 fi
 have_ps='no'
-if test "$have_dps"    = 'yes' || \
-   test "$have_gs" = 'yes' || \
-   test "${native_win32_build}" = 'yes' ; then
-   have_ps='yes'
-fi
+#if test "$have_dps"    = 'yes' || \
+#   test "$have_gs" = 'yes' || \
+#   test "${native_win32_build}" = 'yes' ; then
+#   have_ps='yes'
+#fi
 if test "$have_ps"     = 'yes' ; then
    MAGICK_DELEGATES="$MAGICK_DELEGATES ps"
 fi
